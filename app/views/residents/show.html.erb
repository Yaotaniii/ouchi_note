<h1 class="page-title">入居者詳細：<%= @resident.name %></h1>

<div class="card">
  <h2 class="card-title">基本情報</h2>
  <table class="detail-table">
    <tr>
      <th>部屋番号</th>
      <td><%= link_to @resident.room.room_number, room_path(@resident.room) %></td>
    </tr>
    <tr>
      <th>氏名</th>
      <td><%= @resident.name %></td>
    </tr>
    <tr>
      <th>電話番号</th>
      <td><%= @resident.phone.presence || "未登録" %></td>
    </tr>
    <tr>
      <th>メールアドレス</th>
      <td><%= @resident.email.presence || "未登録" %></td>
    </tr>
    <tr>
      <th>緊急連絡先</th>
      <td><%= @resident.emergency_contact.presence || "未登録" %></td>
    </tr>
    <tr>
      <th>入居日</th>
      <td><%= @resident.move_in_date.strftime("%Y/%m/%d") %></td>
    </tr>
    <tr>
      <th>退去日</th>
      <td><%= @resident.move_out_date&.strftime("%Y/%m/%d") || "入居中" %></td>
    </tr>
    <tr>
      <th>同居人数</th>
      <td><%= @resident.occupants_count %>人</td>
    </tr>
    <tr>
      <th>ペット</th>
      <td>
        <% if @resident.has_pet? %>
          あり（<%= @resident.pet_details.presence || "詳細なし" %>）
        <% else %>
          なし
        <% end %>
      </td>
    </tr>
    <tr>
      <th>備考</th>
      <td><%= @resident.notes.presence || "なし" %></td>
    </tr>
  </table>
</div>

<div class="card">
  <h2 class="card-title">契約情報</h2>
  <% if @resident.contract.present? %>
    <table class="detail-table">
      <tr>
        <th>契約開始日</th>
        <td><%= @resident.contract.start_date.strftime("%Y/%m/%d") %></td>
      </tr>
      <tr>
        <th>敷金</th>
        <td><%= number_with_delimiter(@resident.contract.deposit) %>円</td>
      </tr>
      <tr>
        <th>礼金</th>
        <td><%= number_with_delimiter(@resident.contract.key_money) %>円</td>
      </tr>
      <tr>
        <th>保証人</th>
        <td><%= @resident.contract.guarantor_name.presence || "未登録" %></td>
      </tr>
    </table>
    <p style="margin-top: 15px;">
      <%= link_to "契約詳細を見る", resident_contract_path(@resident), class: "btn btn-secondary btn-small" %>
      <% if current_user.owner? %>
        <%= link_to "契約を編集", edit_resident_contract_path(@resident), class: "btn btn-secondary btn-small" %>
      <% end %>
    </p>
  <% else %>
    <p>契約情報が登録されていません。</p>
    <% if current_user.owner? %>
      <p><%= link_to "契約情報を登録", new_resident_contract_path(@resident), class: "btn btn-primary" %></p>
    <% end %>
  <% end %>
</div>

<div class="action-bar">
  <%= link_to "一覧に戻る", residents_path, class: "btn btn-secondary" %>
  <% if current_user.owner? %>
    <%= link_to "編集", edit_resident_path(@resident), class: "btn btn-primary" %>
  <% end %>
</div>